// ============================================================================
// Prisma Schema - 한미르 관리자 시스템
// ============================================================================
// 데이터베이스: PostgreSQL (Neon)
// 배포: Vercel
// ============================================================================

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DATABASE_URL_UNPOOLED")
}

// ============================================================================
// 기술자료 (Technical Resources)
// ============================================================================
model Resource {
  id        String   @id @default(cuid())
  number    Int      @default(autoincrement())
  category  String   // Catalogue, Manual, Datasheet, Certificate
  title     String
  fileName  String
  filePath  String
  fileSize  String
  format    String   // PDF, DOCX, XLSX, etc.
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("resources")
}

// ============================================================================
// 미디어 콘텐츠 (Media Items)
// ============================================================================
model MediaItem {
  id        String   @id @default(cuid())
  title     String
  category  String   // HANMIR NEWS, HANMIR NOW, 홍보자료실
  thumbnail String
  content   String?  // 상세 내용
  images    String?  // 추가 이미지 (JSON array)
  link      String?  // 외부 링크 (선택)
  views     Int      @default(0) // 조회수
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("media_items")
}

// ============================================================================
// 문의 내역 (Inquiries)
// ============================================================================
model Inquiry {
  id          String   @id @default(cuid())
  name        String   // 담당자 성명
  company     String?  // 업체명 (선택)
  phone       String   // 연락처
  email       String   // 이메일
  interest    String   // 관심 분야 (자동차 배터리, 선박, 건축 및 중공업, 기타)
  message     String?  // 문의 내용
  productId   String?  // 관련 제품 ID (선택)
  isRead      Boolean  @default(false) // 읽음 여부
  createdAt   DateTime @default(now())

  @@map("inquiries")
}

// ============================================================================
// 관리자 활동 로그 (Admin Activity Log)
// ============================================================================
model ActivityLog {
  id        String   @id @default(cuid())
  action    String   // CREATE, UPDATE, DELETE
  target    String   // Resource, MediaItem, Inquiry
  targetId  String
  details   String?
  createdAt DateTime @default(now())

  @@map("activity_logs")
}

// ============================================================================
// 공지사항 (Notices)
// ============================================================================
model Notice {
  id          String   @id @default(cuid())
  number      Int      @default(autoincrement())
  category    String   // 공지, 뉴스, 이벤트, 채용
  title       String
  content     String?
  thumbnail   String?  // 썸네일 이미지 URL
  images      String?  // 추가 이미지 (JSON array)
  attachments String?  // 첨부파일 (JSON array: [{name, url, size}])
  isImportant Boolean  @default(false) // 중요 공지 여부
  views       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("notices")
}

// ============================================================================
// 문의게시판 (QnA Board)
// ============================================================================
model QnaPost {
  id           String    @id @default(cuid())
  number       Int       @default(autoincrement())
  author       String    // 작성자명
  email        String    // 이메일 (필수)
  phone        String    // 연락처 (필수)
  title        String    // 제목
  content      String    // 문의 내용
  password     String    // 비밀번호 (해시)
  isAnswered   Boolean   @default(false)
  answer       String?   // 관리자 답변
  answeredAt   DateTime? // 답변 시간
  views        Int       @default(0)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  @@map("qna_posts")
}

